@model QuanLyGiaoVienCSDLNC.Models.GiaoVienDetail
@{
    ViewData["Title"] = "Chi tiết giáo viên";
}

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2>Chi tiết giáo viên</h2>
                <div>
                    <a asp-action="Edit" asp-route-id="@Model.ThongTinCoBan.MaGV" class="btn btn-warning">
                        <i class="fas fa-edit"></i> Chỉnh sửa
                    </a>
                    <a asp-action="ExportPdf" asp-route-id="@Model.ThongTinCoBan.MaGV" class="btn btn-success">
                        <i class="fas fa-file-pdf"></i> Xuất PDF
                    </a>
                    <a asp-action="Index" class="btn btn-secondary">
                        <i class="fas fa-arrow-left"></i> Quay lại
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Thông tin cơ bản -->
        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h5><i class="fas fa-user"></i> Thông tin cơ bản</h5>
                </div>
                <div class="card-body">
                    <div class="text-center mb-3">
                        <img src="~/images/avatar-default.png" class="rounded-circle" width="100" height="100" alt="Avatar">
                        <h4 class="mt-2">@Model.ThongTinCoBan.HoTen</h4>
                        <p class="text-muted">@Model.ThongTinCoBan.BoMon?.TenBM</p>
                    </div>

                    <table class="table table-borderless">
                        <tr>
                            <th>Mã GV:</th>
                            <td><span class="badge bg-primary">@Model.ThongTinCoBan.MaGV</span></td>
                        </tr>
                        <tr>
                            <th>Ngày sinh:</th>
                            <td>@Model.ThongTinCoBan.NgaySinh.ToString("dd/MM/yyyy")</td>
                        </tr>
                        <tr>
                            <th>Tuổi:</th>
                            <td>@Model.ThongTinCoBan.Tuoi</td>
                        </tr>
                        <tr>
                            <th>Giới tính:</th>
                            <td>@Model.ThongTinCoBan.GioiTinhText</td>
                        </tr>
                        <tr>
                            <th>Quê quán:</th>
                            <td>@Model.ThongTinCoBan.QueQuan</td>
                        </tr>
                        <tr>
                            <th>Địa chỉ:</th>
                            <td>@Model.ThongTinCoBan.DiaChi</td>
                        </tr>
                        <tr>
                            <th>Email:</th>
                            <td><a href="mailto:@Model.ThongTinCoBan.Email">@Model.ThongTinCoBan.Email</a></td>
                        </tr>
                        <tr>
                            <th>Số ĐT:</th>
                            <td><a href="tel:@Model.ThongTinCoBan.SDT">@Model.ThongTinCoBan.SDT</a></td>
                        </tr>
                        <tr>
                            <th>Bộ môn:</th>
                            <td>@Model.ThongTinCoBan.BoMon?.TenBM</td>
                        </tr>
                        <tr>
                            <th>Khoa:</th>
                            <td>@Model.ThongTinCoBan.BoMon?.Khoa?.TenKhoa</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

        <!-- Tabs thông tin chi tiết -->
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <ul class="nav nav-tabs card-header-tabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" data-bs-toggle="tab" href="#hocvi-tab">
                                <i class="fas fa-graduation-cap"></i> Học vị & Học hàm
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#lylich-tab">
                                <i class="fas fa-book"></i> Lý lịch khoa học
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#thongke-tab">
                                <i class="fas fa-chart-bar"></i> Thống kê
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="card-body">
                    <div class="tab-content">
                        <!-- Tab học vị & học hàm -->
                        <div class="tab-pane fade show active" id="hocvi-tab">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>Danh sách học vị</h6>
                                    @if (Model.DanhSachHocVi?.Any() == true)
                                    {
                                        <div class="table-responsive">
                                            <table class="table table-sm">
                                                <thead>
                                                    <tr>
                                                        <th>Tên học vị</th>
                                                        <th>Ngày nhận</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @foreach (var hocVi in Model.DanhSachHocVi)
                                                    {
                                                        <tr>
                                                            <td>@hocVi.TenHocVi</td>
                                                            <td>@hocVi.NgayNhan.ToString("dd/MM/yyyy")</td>
                                                        </tr>
                                                    }
                                                </tbody>
                                            </table>
                                        </div>
                                    }
                                    else
                                    {
                                        <p class="text-muted">Chưa có học vị nào</p>
                                    }
                                </div>
                                <div class="col-md-6">
                                    <h6>Danh sách học hàm</h6>
                                    @if (Model.DanhSachHocHam?.Any() == true)
                                    {
                                        <div class="table-responsive">
                                            <table class="table table-sm">
                                                <thead>
                                                    <tr>
                                                        <th>Tên học hàm</th>
                                                        <th>Ngày nhận</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @foreach (var hocHam in Model.DanhSachHocHam)
                                                    {
                                                        <tr>
                                                            <td>@hocHam.TenHocHam</td>
                                                            <td>@hocHam.NgayNhan.ToString("dd/MM/yyyy")</td>
                                                        </tr>
                                                    }
                                                </tbody>
                                            </table>
                                        </div>
                                    }
                                    else
                                    {
                                        <p class="text-muted">Chưa có học hàm nào</p>
                                    }
                                </div>
                            </div>
                        </div>

                        <!-- Tab lý lịch khoa học -->
                        <div class="tab-pane fade" id="lylich-tab">
                            @if (Model.LyLichKhoaHoc != null)
                            {
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6>Thông tin đại học</h6>
                                        <table class="table table-borderless table-sm">
                                            <tr>
                                                <th>Hệ đào tạo:</th>
                                                <td>@Model.LyLichKhoaHoc.HeDaoTaoDH</td>
                                            </tr>
                                            <tr>
                                                <th>Nơi đào tạo:</th>
                                                <td>@Model.LyLichKhoaHoc.NoiDaoTaoDH</td>
                                            </tr>
                                            <tr>
                                                <th>Ngành học:</th>
                                                <td>@Model.LyLichKhoaHoc.NganhHocDH</td>
                                            </tr>
                                            <tr>
                                                <th>Năm tốt nghiệp:</th>
                                                <td>@Model.LyLichKhoaHoc.NamTotNghiepDH</td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="col-md-6">
                                        <h6>Thông tin sau đại học</h6>
                                        <table class="table table-borderless table-sm">
                                            <tr>
                                                <th>Thạc sĩ:</th>
                                                <td>@Model.LyLichKhoaHoc.ThacSiChuyenNganh</td>
                                            </tr>
                                            <tr>
                                                <th>Tiến sĩ:</th>
                                                <td>@Model.LyLichKhoaHoc.TienSiChuyenNganh</td>
                                            </tr>
                                            <tr>
                                                <th>Nơi đào tạo TS:</th>
                                                <td>@Model.LyLichKhoaHoc.NoiDaoTaoTS</td>
                                            </tr>
                                            <tr>
                                                <th>Năm cấp bằng TS:</th>
                                                <td>@Model.LyLichKhoaHoc.NamCapBangTS</td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                                @if (!string.IsNullOrEmpty(Model.LyLichKhoaHoc.TenLuanVanTotNghiep))
                                {
                                    <div class="mt-3">
                                        <h6>Luận văn tốt nghiệp:</h6>
                                        <p>@Model.LyLichKhoaHoc.TenLuanVanTotNghiep</p>
                                    </div>
                                }
                            }
                            else
                            {
                                <p class="text-muted">Chưa có thông tin lý lịch khoa học</p>
                            }
                        </div>

                        <!-- Tab thống kê -->
                        <div class="tab-pane fade" id="thongke-tab">
                            @if (Model.ThongKe != null)
                            {
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="card bg-primary text-white">
                                            <div class="card-body text-center">
                                                <h4>@Model.ThongKe.TongGioGiangDay</h4>
                                                <p class="mb-0">Giờ giảng dạy</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="card bg-success text-white">
                                            <div class="card-body text-center">
                                                <h4>@Model.ThongKe.TongGioNCKH</h4>
                                                <p class="mb-0">Giờ NCKH</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="card bg-warning text-white">
                                            <div class="card-body text-center">
                                                <h4>@Model.ThongKe.TongGioKhaoThi</h4>
                                                <p class="mb-0">Giờ khảo thí</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="card bg-info text-white">
                                            <div class="card-body text-center">
                                                <h4>@Model.ThongKe.TongGioQuyChuan</h4>
                                                <p class="mb-0">Giờ quy chuẩn</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mt-3">
                                    <div class="col-md-6">
                                        <h6>Tiến độ hoàn thành</h6>
                                        <div class="mb-2">
                                            <span>Giảng dạy: @Model.ThongKe.PhanTramHoanThanhGiangDay%</span>
                                            <div class="progress">
                                                <div class="progress-bar bg-primary" style="width: @Model.ThongKe.PhanTramHoanThanhGiangDay%"></div>
                                            </div>
                                        </div>
                                        <div class="mb-2">
                                            <span>NCKH: @Model.ThongKe.PhanTramHoanThanhNCKH%</span>
                                            <div class="progress">
                                                <div class="progress-bar bg-success" style="width: @Model.ThongKe.PhanTramHoanThanhNCKH%"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <h6>Trạng thái tổng thể</h6>
                                        <span class="badge bg-@(Model.ThongKe.TrangThaiHoanThanh == "Đạt" ? "success" : "warning") fs-6">
                                            @Model.ThongKe.TrangThaiHoanThanh
                                        </span>
                                    </div>
                                </div>
                            }
                            else
                            {
                                <p class="text-muted">Chưa có dữ liệu thống kê</p>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Action buttons -->
    <div class="row mt-3">
        <div class="col-12 text-center">
            <a asp-action="ManageAcademic" asp-route-id="@Model.ThongTinCoBan.MaGV" class="btn btn-primary">
                <i class="fas fa-graduation-cap"></i> Quản lý học thuật
            </a>
            <a asp-action="ManagePosition" asp-route-id="@Model.ThongTinCoBan.MaGV" class="btn btn-info">
                <i class="fas fa-briefcase"></i> Quản lý chức vụ
            </a>
            <a asp-action="Statistics" asp-route-id="@Model.ThongTinCoBan.MaGV" class="btn btn-success">
                <i class="fas fa-chart-line"></i> Xem thống kê chi tiết
            </a>
        </div>
    </div>
</div>